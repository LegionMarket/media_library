!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){"use strict";function t(e){var t=/^.*(youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,i=e.match(t);return i&&11==i[2].length?i[2]:void 0}function i(t,o){this.$element=e(t),this.options=e.extend({},i.DEFAULTS,e.isPlainObject(o)&&o),this.init()}var o="qor.medialibrary.action",r="enable."+o,a="disable."+o,n="blur."+o,d="focus."+o,l="switched.qor.tabbar.radio",s='[data-toggle="qor.tab.radio"]',c='[name="QorResource.SelectedType"]',f=".qor-video__link",u=".qor-medialibrary__video-link",h=".qor-medialibrary__video",v=".qor-file__options";return i.prototype={constructor:i,init:function(){this.bind(),this.initMedia()},bind:function(){e(document).on(l,s,this.resetMediaData).on(n,f,this.setVideo).on(d,f,this.initVideo)},unbind:function(){e(document).off(l,s,this.resetMediaData).off(n,f,this.setVideo).off(d,f,this.initVideo)},initVideo:function(t){var i=e(t.target);this.originalLink=i.val()},initMedia:function(){e(h).each(function(){var t=e(this),i=t.data().videolink,o=i&&i.match(/\.mp4$|\.m4p$|\.m4v$|\.m4v$|\.mov$|\.mpeg$|\.webm$|\.avi$|\.ogg$|\.ogv$/);o&&(t.closest("tr").data("isUploadedVideo",!0),t.parent().addClass("qor-table--video qor-table--video-internal").html('<video width=100% height=100% controls><source src="'+i+'" type="video/'+o[0].replace(".","")+'"></video>'))}),e(u).each(function(){var i=e(this),o=i.data("videolink"),r=t(o);r&&(i.closest("tr").data("isExternalVideo",!0),i.parent().addClass("qor-table--video qor-table--video-external").html('<iframe width="100%" height="100%" src="https://www.youtube.com/embed/'+r+'?rel=0" frameborder="0" allowfullscreen></iframe>'))})},setVideo:function(i){var o=e(i.target),r=o.closest("[data-tab-source]"),a=o.closest(s),n=a.find(v),d=JSON.parse(n.val()),l=o.val(),c=r.find("iframe"),f=t(l);l!=this.originalLink&&(d.SelectedType="video",d.Video=l,n.val(JSON.stringify(d)),f&&(c.length&&c.remove(),r.append('<iframe width="100%" height="400" src="https://www.youtube.com/embed/'+t(l)+'?rel=0" frameborder="0" allowfullscreen></iframe>')))},resetMediaData:function(t,i,o){var r=e(i),a=r.find(v),n=r.find('[data-tab-source="video"] .qor-fieldset__alert'),d=JSON.parse(a.val());d.SelectedType=o,"video"==o&&(d.Video=r.find(f).val(),n.length&&n.remove()),e(c).val(o),a.val(JSON.stringify(d))},destroy:function(){this.unbind()}},i.DEFAULTS={},e.fn.qorSliderAfterShow=e.fn.qorSliderAfterShow||{},e.fn.qorSliderAfterShow.renderMediaVideo=function(){var i=e('[data-tab-source="video"]'),o=i.length&&i.data().videourl;i.length&&o&&i.append('<iframe width="100%" height="400" src="https://www.youtube.com/embed/'+t(o)+'?rel=0&fs=0&modestbranding=1&disablekb=1" frameborder="0" allowfullscreen></iframe>')},i.plugin=function(t){return this.each(function(){var r,a=e(this),n=a.data(o);if(!n){if(/destroy/.test(t))return;a.data(o,n=new i(this,t))}"string"==typeof t&&e.isFunction(r=n[t])&&r.apply(n)})},e(function(){var t=".qor-table--medialibrary";e(document).on(a,function(o){i.plugin.call(e(t,o.target),"destroy")}).on(r,function(o){i.plugin.call(e(t,o.target))}).triggerHandler(r)}),i});